services:
  # 1. 메인 게이트웨이 서버
  kroki:
    image: yuzutech/kroki
    container_name: kroki-main
    environment:
      - KROKI_BLOCKDIAG_HOST=kroki-blockdiag
      - KROKI_MERMAID_HOST=kroki-mermaid
      - KROKI_EXCALIDRAW_HOST=kroki-excalidraw
    ports:
      - "8100:8000"
    restart: always

  # 2. rackdiag, nwdiag 등을 처리하는 엔진
  kroki-blockdiag:
    image: yuzutech/kroki-blockdiag
    container_name: kroki-blockdiag
    expose:
      - "8001"
    restart: always

  # 3. Mermaid 처리 엔진 (Wiki.js 내장 외에 Kroki 직접 호출용)
  kroki-mermaid:
    image: yuzutech/kroki-mermaid
    container_name: kroki-mermaid
    expose:
      - "8002"
    restart: always

  # 4. 손그림 스타일 다이어그램 엔진
  kroki-excalidraw:
    image: yuzutech/kroki-excalidraw
    container_name: kroki-excalidraw
    expose:
      - "8004"
    restart: always
